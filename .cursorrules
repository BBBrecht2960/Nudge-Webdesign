# Project Rules

## Security (HARD RULES â€” ALWAYS APPLY)

You must follow the project security rules in SECURITY_RULES.md for all code in this project and in the future. Summarized:

1. **No custom auth/session/JWT** unless explicitly requested. Use established auth providers.
2. **All data access server-side** with **authorization checks** on every access.
3. **Strict request validation** (e.g. Zod). Reject unknown fields. Use `.strict()` or equivalent.
4. **Never put secrets in client code; never log secrets.**
5. **Parameterized queries / ORM only.** No string-concatenated SQL.
6. **Rate limiting** on public endpoints (login, signup, contact, leads, etc.).
7. **Authorization tests:** at least 3 per protected route (unauthenticated, wrong user/role, correct user/role).
8. **If unsure:** stop and propose the safest default. Prefer deny over allow.

For full wording and context, read SECURITY_RULES.md.

## Table layout (admin tabellen)

Gebruik voor alle admin-tabellen hetzelfde layoutpatroon: scroll-container volle breedte, binnen de scroll padding + rand, dan de tabel. Zo vult de tabel de kaart en scrollt hij horizontaal op kleine schermen.

**Standaard (kaart met header, bv. leads/klanten/analytics):**
```tsx
<div className="w-full min-w-0 overflow-x-auto">
  <div className="px-5 pb-4">
    <div className="rounded-lg border border-border/80">
      <table className="w-full min-w-[640px] ...">...</table>
    </div>
  </div>
</div>
```

**Kaart met eigen padding (bv. dashboard recent leads):** alleen scroll + rand, geen extra `px-5 pb-4`:
```tsx
<div className="w-full min-w-0 overflow-x-auto">
  <div className="rounded-lg border border-border/80">
    <table className="w-full min-w-[500px] ...">...</table>
  </div>
</div>
```

## Backend & changes (NUDGE)

- **Niets kapot maken:** bestaande backend, admin, leadflow, offerte builder, rollen en integraties moeten 100% blijven werken.
- **Minimal change:** alleen wijzigen wat nodig is; geen grote refactors of "cleanup" zonder expliciete opdracht.
- **Geen accidental deletion:** geen code, endpoints, types, env vars of bestanden verwijderen zonder zekerheid dat het nergens wordt gebruikt; bij twijfel laten staan.
- **Verificatie verplicht:** voor elke change de checklist in NUDGE_RULES.md doorlopen (auth, leads, offerte, PDF, mail, user management, etc.).

Volledige regels: NUDGE_RULES.md.
